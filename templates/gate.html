<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QR Scanner</title>
    <script src="/static/js/qr-scanner.umd.min.js"></script>
</head>
<body>
<style>
    hr {
        margin-top: 32px;
    }
    input[type="file"] {
        display: block;
        margin-bottom: 16px;
    }
    div {
        margin-bottom: 16px;
    }
    #flash-toggle {
        display: none;
    }
</style>
<h1>Please scan your QR</h1>
<div>
    <video id="qr-video" style="height: 400px; width: 400px;"></video>
</div>
<div>
    <!--<span id="cam-qr-result">None</span>-->
</div>




<script type="module">;
    QrScanner.WORKER_PATH = '/static/js/qr-scanner-worker.min.js';
    const video = document.getElementById('qr-video');   
    const camQrResult = document.getElementById('cam-qr-result');

    console.log(QrScanner.hasCamera()); 

    function setResult(result) {
        console.log("Decoded:", result);
        console.log(Date().toString());
        scanner.stop();
        const Http = new XMLHttpRequest();
        const url = 'http://localhost:8000/gates';
        const data ={
            code: result
        }
        Http.open("POST",url,data);
        Http.send();

        // send shit to server.py
        // loading screen
        //change to green or red screen
        scanner.start();
    }

    const scanner = new QrScanner(video, result => setResult(result));
    scanner.start()


</script>
</body>
</html>